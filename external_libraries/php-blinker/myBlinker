#!/usr/bin/env php
<?php

require 'vendor/autoload.php';

use PhpGpio\Gpio;

$arguments_count = (int)$argc;
echo "$arguments_count\n";

$pin_count = $arguments_count - 1;
$sleep_argument = $pin_count;

for ($i = 1; $i < ($pin_count); $i++) {
	echo 'count';
	$pin[$i] = (int)$argv[$i];

}

$sleep_time = (int)$argv[$sleep_argument];



echo "Setting up pin 17\n";
$gpio = new GPIO();
for ($i = 1; $i < $pin_count; $i++) {

	$gpio->setup($pin[$i], "out");

}


echo "Turning on pin 17\n";

for ($i = 1; $i < $pin_count; $i++) {

	$gpio->output($pin[$i], 1);

}
echo "Sleeping!\n";
sleep($sleep_time);

echo "Turning off pin 17\n";
for ($i = 1; $i < $pin_count; $i++) {

	$gpio->output($pin[$i], 0);

}

echo "Unexporting all pins\n";
$gpio->unexportAll();